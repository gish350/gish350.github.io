+++
title = 'Анализ AgentTesla'
date = 2024-08-04T21:14:26+10:00
draft = false
+++

## Введение

AgentTesla — это тип вредоносного ПО, известный как Remote Access Trojan (RAT) и кейлоггер. Оно активно используется злоумышленниками для кражи конфиденциальной информации с заражённых систем.

## Общие сведения

**1. Тип:** Remote Access Trojan (RAT) и кейлоггер

**2. Основные характеристики:**
* **Шпионские возможности:** AgentTesla способен перехватывать и записывать нажатия клавиш, делать скриншоты, захватывать буфер обмена и собирать данные из различных приложений.
* **Кража данных:** Вредоносное ПО часто нацелено на кражу данных аутентификации из веб-браузеров, почтовых клиентов и других приложений.
* **Удалённое управление:** AgentTesla позволяет злоумышленникам удалённо управлять заражённой системой, выполняя команды и действия на целевом устройстве.

**3. Распространение:**
* **Фишинговые атаки:** AgentTesla часто распространяется через фишинговые электронные письма, содержащие вредоносные вложения или ссылки.
* **Эксплоиты:** Использование уязвимостей в программном обеспечении для загрузки и выполнения вредоносного кода.
* **Социальная инженерия:** Злоумышленники могут использовать методы социальной инженерии для обмана пользователей с целью установки вредоносного ПО.

**4. Вектор атаки:**
* **Вложения в электронных письмах:** Вредоносные документы, такие как файлы Word или Excel с вредоносными макросами, или архивы, содержащие вредоносные исполняемые файлы.
* **Ссылки на вредоносные сайты:** Ссылки в письмах, ведущие на сайты, которые автоматически загружают и запускают AgentTesla.

**5. Функции и возможности:**
* **Кейлоггер:** Записывает все нажатия клавиш, что позволяет злоумышленникам захватывать пароли и другую конфиденциальную информацию.
* **Скриншоты:** Делает скриншоты экрана заражённого компьютера.
* **Сетевые данные:** Собирает данные о сетевой активности, включая информацию о подключениях и передаваемых данных.
* **Данные из приложений:** Извлечение данных из  веб-браузеров (Chrome, Firefox, Internet Explorer), почтовых клиентов (Outlook, Thunderbird) и других приложений.
* **Экфильтрация данных:** Передача собранных данных на удалённый сервер злоумышленников через различные протоколы, включая SMTP, FTP и HTTP.

## Статический анализ

Даннные, полученые в DIE:

**1. Структура файла**
	**Размер файла:** 1.01 МБ  
	**Тип файла:** PE (Portable Executable)  
	**Компилятор**: AutoIt(3.XX)
	**Хэш SHA-256:** D4C4EE49A5CE076550C8305FCD63FE86707A251A2CA7D47C67D0DBEF66B2A1E3

**2. Секции файла**

| Offset   | Size     | Entropy | Status     | Name                 |
| -------- | -------- | ------- | ---------- | -------------------- |
| 00000000 | 00000400 | 2.93857 | not packed | PE Header            |
| 00000400 | 0008e000 | 6.67525 | packed     | Section(0)['.text']  |
| 0008e400 | 0002fe00 | 5.76325 | not packed | Section(1)['.rdata'] |
| 000be200 | 00005200 | 1.19645 | not packed | Section(2)['.data']  |
| 000c3400 | 00038400 | 7.78357 | packed     | Section(3)['.rsrc']  |
| 000fb800 | 00007200 | 6.78400 | packed     | Section(4)['.reloc'] |


 **2. Структура и импортируемые библиотеки**
**Библиотеки:**
- placeholder

**3. Основные функции и их анализ**
**Основные функции:**
- placeholder
**4. Анализ строк и конфигурационных данных**
**Строки:**
-placeholder

**5. Конфигурационный блок**
**Ключевые функции:**
- placeholder

**6. Обфускация и методы уклонения**
**Методы обфускации:**
- placeholder

## Динамический анализ

**1. Сетевая активность**
* placeholder
**2. Файловые операции**
* placeholder
**3. Отладка**
Отладка в x64dbg:
1. Проверка IsDebuggerPresent, после чего выводится сообщение: *"This is a third-party compiled AutoIt Script."*
2. Process hollowing:
		1. Создание легетимного процесса
			AgentTesla создает  процесс `RegSvcs.exe` с флагом CREATE_SUSPENDED, используя следующую команду: placeholder
		2. Запись полезной нагрузки: placeholder
		1. Возобновление процесса с помощью ResumeThread:
			placeholder




## Цепочка заражения
Placeholder
## Indicators of Compromise
| Категория |                              SHA256                              |       Описание       |
| :-------: | :--------------------------------------------------------------: | :------------------: |
|   Файлы   | d4c4ee49a5ce076550c8305fcd63fe86707a251a2ca7d47c67d0dbef66b2a1e3 | Изначальный ZIP-файл |
## Mitre Attack TTPs
Placeholder
## Ссылки
* https://app.any.run/tasks/ee2f1b8a-8be0-4444-9d1a-fbcb87131191
* https://bazaar.abuse.ch/sample/d4c4ee49a5ce076550c8305fcd63fe86707a251a2ca7d47c67d0dbef66b2a1e3/